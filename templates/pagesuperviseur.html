{% extends 'base.html' %}
{% block content %}
{% load leaflet_tags %}
{% leaflet_js %}
{% leaflet_css %}
{% leaflet_map 'mapid' %}
<div class="container">
  <form method="POST">
    {% csrf_token %}
    <br>
    <div class="text-center">
    <h1 style='color:rgb(252, 8, 8)'>Choisit votre position</h1>
    <div class="container" id="map" style="height: 500px; width: 1000px; margin-top: 30px">
      <div class="d-flex justify-content-center">
        {{form}}
      </div>
    </div>
    <br>
    <button class="btn btn-outline-primary my-2 my-sm-0" type="submit" value="save" style='width:30%'>
      save
    </button>
  </div>
  </form>
</div>



<script>
    var map = L.map('mapid').setView([37.215 ,10.12], 13);
    L.control.layers({
        
    'Satellite': L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
    attribution: 'Sources: Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community',
        maxZoom: 18,
        tileSize: 512,
        zoomOffset: -1,
        
    }),
    'Streets': L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors'
    })
}).addTo(map);
var marker;

  map.on("click", function (e) {
    // If marker is already defined, remove it before adding a new one
    if (marker) {
      map.removeLayer(marker);
    }
    // Add new marker at double-clicked location
    marker = L.marker(e.latlng).addTo(map);
    document.getElementById("lat").value = e.latlng.lat;
    document.getElementById("lng").value = e.latlng.lng;
  });

    
    </script>
    
{% endblock %}